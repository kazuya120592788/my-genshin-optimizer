import{r as p,x as E,d as e,e as n,ac as se,au as Fe,a as W,y as F,bP as le,f as h,G as o,h as w,cm as Ne,cn as Ke,c2 as Pe,co as $e,W as be,cp as qe,bH as ze,ao as he,Z as Ge,cq as ue,cr as Ve,cs as re,L as _,ai as ce,aj as Q,M as B,N as k,T as A,ct as He,b$ as R,cl as P,I as $,o as Y,cu as ve,a9 as Ue,cv as Je,af as M,ap as ie,ak as oe,ae as Te,cw as Qe,cx as Ye,P as Ze,cy as pe,cz as Xe,cA as et,av as tt,aL as Z,cB as at,cC as nt,bM as we,cg as rt,t as Ie,v as Se,w as Me,g as De,s as z,bI as de,bJ as st,a$ as ke,ci as lt,cD as ct,cE as me,cF as it,cG as ot,D as Ee,bY as ge,z as dt,H as ht,cH as ut,cI as fe,bL as pt,S as q,i as mt,l as gt,cJ as ft,c9 as xt,cK as yt,a5 as Ct,aC as bt,ab as vt,as as Tt,cL as wt,aG as It,aH as St,b5 as ne,aI as Mt,cM as Dt,b9 as kt,cN as Et,cO as jt,bl as Wt,aK as Bt,cP as At,cQ as Lt,cR as Ot,cS as je,F as Rt,E as _t,b as Ft,A as Nt,cT as Kt}from"./index-BaYcb-Td.js";import{u as Pt,B as We,a as Be,L as $t,b as qt,T as zt,c as Gt,C as Vt,d as Ht,e as Ut,E as Jt,f as xe}from"./LoadoutInfoAlert-Cdhw4_JU.js";import{T as Ae}from"./TeamCard-DdgCSKqB.js";import{u as Qt}from"./useTeamChar-dc2Q39gy.js";import{O as Yt,L as Zt}from"./TeamDelModal-DMjNQF0m.js";function Xt(){const t=p.useRef(!0),r=t.current;return r&&(t.current=!1),r}function ea(){const{t}=E("page_character");return e(Fe,{severity:"warning",children:n(se,{t,i18nKey:"noLoadout",children:["Looks like you haven't added any loadout/Teams with this character yet. You need to create a loadout+team with this character to"," ",e("strong",{children:"create builds"}),", ",e("strong",{children:"theorycraft"}),", or"," ",e("strong",{children:"optimize"}),"."]})})}function ta(){const t=W(),r=F();return p.useCallback(a=>{t.chars.get(a)||t.chars.getWithInitWeapon(a),r(`/characters/${a}`)},[r,t])}function aa({buildId:t,characterKey:r}){const{name:s,description:a,weaponId:l,artifactIds:u}=Pt(t),d=le(r).weaponType;return e(We,{name:s,description:a,hideFooter:!0,children:e(h,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"stretch"},children:n(o,{container:!0,spacing:1,columns:{xs:2,sm:2,md:2,lg:3,xl:3},children:[e(o,{item:!0,xs:1,children:e(w,{sx:{height:"100%",maxHeight:"8em"},children:e(Ne,{weaponId:l,weaponTypeKey:d})})}),Object.entries(u).map(([m,y])=>e(o,{item:!0,xs:1,children:e(w,{sx:{height:"100%",maxHeight:"8em"},children:e(Ke,{artifactId:y,slotKey:m})})},y||m))]})})})}function na({buildTcId:t}){const r=Be(t),{name:s,description:a}=r;return e(We,{name:s,description:a,hideFooter:!0,children:e(ra,{buildTcId:t})})}function ra({buildTcId:t}){const{weapon:r,artifact:{slots:s,substats:{stats:a},sets:l}}=Be(t),u=Pe(r.key),d=Object.entries(a),m=d.slice(0,5),y=d.slice(5);return e(h,{children:n(o,{container:!0,spacing:1,columns:{xs:2,sm:2,md:2,lg:2,xl:2},children:[e(o,{item:!0,xs:1,children:n(h,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e($e,{weapon:r,weaponSheet:u}),!!Object.keys(l).length&&e(w,{sx:{flexGrow:1},children:e(h,{sx:{p:1,display:"flex",flexDirection:"column",gap:1},children:Object.entries(l).map(([c,i])=>n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(be,{size:2,src:qe(c,"flower")}),e("span",{children:e(ze,{setKey:c})}),n(he,{children:["x",i]})]},c))})})]})}),e(o,{item:!0,xs:1,children:e(w,{sx:{flexGrow:1,height:"100%",p:1,display:"flex",flexDirection:"column",gap:1,justifyContent:"space-between"},children:Object.entries(s).map(([c,{level:i,statKey:f}])=>n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Ge,{slotKey:c}),n(he,{children:["+",i]}),e(ue,{statKey:f})]},c))})}),[m,y].map((c,i)=>e(o,{item:!0,xs:1,children:e(w,{sx:{flexGrow:1,height:"100%"},children:e(h,{sx:{p:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",gap:1},children:c.map(([f,C])=>n(h,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"space-between"},children:[e(ue,{statKey:f}),n("span",{children:[Ve(C,re(f)),re(f)]})]},f))})})},i))]})})}function sa({show:t,onHide:r,teamCharId:s,onDelete:a,teamIds:l,conditionalCount:u}){const{t:d}=E("loadout"),m=W(),{name:y,description:c,buildIds:i,buildTcIds:f,customMultiTargets:C,bonusStats:T}=m.teamChars.get(s),I=p.useCallback(()=>{r(),a()},[a,r]);return e(oe,{open:t,onClose:r,containerProps:{maxWidth:"md"},children:n(w,{children:[e(_,{title:e("span",{children:n(se,{t:d,i18nKey:"loadoutDelModal.title",name:y,children:["Delete Loadout: ",e("strong",{children:{name:y}}),"?"]})}),action:e(ce,{onClick:r,children:e(Q,{})})}),e(B,{}),n(k,{children:[c&&e(w,{bgt:"dark",sx:{mb:2},children:e(k,{children:c})}),e(A,{children:d("loadoutDelModal.desc")}),n(He,{sx:{listStyleType:"disc",pl:4},children:[!!i.length&&e(R,{sx:{display:"list-item"},children:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[d("loadoutDelModal.builds"),i.length," ",e(P,{title:e(h,{children:i.map(x=>{var v;return n(A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Y,{}),e("span",{children:(v=m.builds.get(x))==null?void 0:v.name})]},x)})}),children:e($,{})})]})}),!!f.length&&e(R,{sx:{display:"list-item"},children:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[d("loadoutDelModal.tcBuilds"),f.length," ",e(P,{title:e(h,{children:f.map(x=>{var v;return n(A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Y,{}),e("span",{children:(v=m.buildTcs.get(x))==null?void 0:v.name})]},x)})}),children:e($,{})})]})}),!!C.length&&e(R,{sx:{display:"list-item"},children:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[d("loadoutDelModal.mTargets"),C.length," ",e(P,{title:e(h,{children:C.map((x,v)=>n(A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(ve,{}),e("span",{children:x.name})]},v))}),children:e($,{})})]})}),!!Object.keys(T).length&&n(R,{sx:{display:"list-item"},children:[d("loadoutDelModal.bonus"),Object.keys(T).length]}),!!u&&n(R,{sx:{display:"list-item"},children:[d("loadoutDelModal.condi"),u]}),e(R,{sx:{display:"list-item"},children:d("loadoutDelModal.optConfig")}),!!l.length&&e(R,{sx:{display:"list-item"},children:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[n("span",{children:[d("loadoutDelModal.affected"),l.length]}),e(P,{title:e(h,{children:l.map(x=>{var v;return n(A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Ue,{}),e("span",{children:(v=m.teams.get(x))==null?void 0:v.name})]},x)})}),children:e($,{})})]})})]})]}),n(Je,{sx:{float:"right"},children:[e(M,{startIcon:e(Q,{}),color:"secondary",onClick:r,children:d("loadoutDelModal.cancel")}),e(M,{startIcon:e(ie,{}),color:"error",onClick:I,children:d("loadoutDelModal.delete")})]})]})})}function la({show:t,onHide:r,teamCharId:s,teamIds:a}){const{t:l}=E("loadout"),[u,d,m]=Te(),y=F(),c=W(),{key:i,name:f,description:C,buildIds:T,buildTcIds:I,customMultiTargets:x,bonusStats:v,optConfigId:S,conditional:G}=Qt(s),{optimizationTarget:V}=Qe(S),X=()=>{r(),c.teamChars.remove(s)},ee=()=>{c.teamChars.duplicate(s)&&r()},te=b=>{const j=c.teams.new();c.teams.set(j,U=>{U.loadoutData[0]={teamCharId:b}}),y(`/teams/${j}`)},H=p.useMemo(()=>{let b=0;return Ye(G,[],j=>typeof j!="object",()=>b++),b},[G]);return e(oe,{open:t,onClose:r,containerProps:{maxWidth:"lg"},children:n(w,{children:[e(_,{title:n(h,{display:"flex",gap:1,alignItems:"center",children:[e(Ze,{}),e("strong",{children:f})]}),action:e(ce,{onClick:r,children:e(Q,{})})}),e(B,{}),n(k,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e($t,{}),e(pe,{fullWidth:!0,label:l("loadoutEditor.label"),placeholder:l("loadoutEditor.placeholder"),value:f,onChange:b=>c.teamChars.set(s,{name:b})}),e(pe,{fullWidth:!0,label:l("loadoutEditor.desc"),value:C,onChange:b=>c.teamChars.set(s,{description:b}),multiline:!0,minRows:2}),e(h,{children:n(o,{container:!0,columns:{xs:1,md:2},spacing:2,children:[e(o,{item:!0,xs:1,children:e(M,{color:"info",onClick:()=>ee(),fullWidth:!0,startIcon:e(Xe,{}),children:l("loadoutEditor.dupBtn")})}),n(o,{item:!0,xs:1,children:[e(sa,{show:u,onHide:m,onDelete:X,teamCharId:s,teamIds:a,conditionalCount:H}),e(M,{fullWidth:!0,startIcon:e(ie,{}),color:"error",onClick:d,children:l("loadoutEditor.delBtn")})]})]})}),e(h,{children:n(o,{container:!0,columns:{xs:1,md:2},spacing:2,children:[!!Object.keys(v).length&&e(o,{item:!0,xs:1,children:e(ca,{bonusStats:v})}),!!V&&e(o,{item:!0,xs:1,children:n(w,{bgt:"light",children:[e(_,{title:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(et,{}),e("span",{children:l("loadoutEditor.optTarget")})]})}),e(B,{}),e(k,{children:e(tt,{divider:e(B,{orientation:"vertical",flexItem:!0}),spacing:1,children:e(Yt,{optimizationTarget:V,customMultiTargets:x})})})]})}),!!x.length&&e(o,{item:!0,xs:1,children:e(ia,{customMultiTargets:x})}),e(o,{item:!0,xs:1,children:e(w,{bgt:"light",children:e(k,{children:n(A,{variant:"h6",children:[l("loadoutEditor.conditionals"),e("strong",{children:H})]})})})})]})})]}),e(B,{}),e(_,{title:n(h,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(Y,{}),e("span",{children:l("loadoutEditor.builds")})]})}),e(B,{}),n(k,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(qt,{}),e(h,{children:e(o,{container:!0,columns:{xs:1,md:2},spacing:2,children:T.map(b=>e(o,{item:!0,xs:1,children:e(aa,{buildId:b,characterKey:i})},b))})}),e(zt,{}),e(h,{children:e(o,{container:!0,columns:{xs:1,md:2},spacing:2,children:I.map(b=>e(o,{item:!0,xs:1,children:e(na,{buildTcId:b})},b))})})]}),e(B,{}),e(_,{title:n(h,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(Y,{}),e("span",{children:l("loadoutEditor.teams")})]})}),e(B,{}),n(k,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(Gt,{}),n(o,{container:!0,columns:{xs:1,md:2},spacing:2,children:[a.map(b=>e(o,{item:!0,xs:1,children:e(Ae,{bgt:"light",teamId:b,onClick:j=>y(`/teams/${b}${j?`/${j}`:""}`)})},b)),e(o,{item:!0,xs:1,children:e(M,{fullWidth:!0,sx:{height:"100%",backgroundColor:"contentLight.main"},variant:"outlined",onClick:()=>te(s),color:"info",startIcon:e(Z,{}),children:l("loadoutEditor.addNewTeam")})})]})]})]})})}function ca({bonusStats:t}){const{t:r}=E("loadout");return n(w,{bgt:"light",children:[e(_,{title:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(at,{}),e("span",{children:r("loadoutEditor.bonusStats")})]}),titleTypographyProps:{variant:"h6"}}),e(we,{bgt:"light",sections:[{fields:Object.entries(t).map(([s,a])=>({text:nt.getStr(s)??s,value:a,unit:re(s)}))}]})]})}function ia({customMultiTargets:t}){const{t:r}=E("loadout");return n(w,{bgt:"light",children:[e(_,{title:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(ve,{}),e("span",{children:r("loadoutEditor.mltTargets")})]}),titleTypographyProps:{variant:"h6"}}),e(we,{bgt:"light",sections:[{fields:t.map(({name:s,description:a})=>({text:s,value:a?e(P,{title:a,children:e($,{})}):void 0}))}]})]})}const oa={xs:1,md:2};function da({teamCharId:t,teamIds:r}){const{t:s}=E("page_character"),a=F(),l=W(),u=c=>{const i=l.teams.new();l.teams.set(i,f=>{f.loadoutData[0]={teamCharId:c}}),a(`/teams/${i}`)},[d,m,y]=Te();return n(rt,{children:[e(la,{show:d,onHide:y,teamCharId:t,teamIds:r}),n(w,{bgt:"light",children:[e(M,{fullWidth:!0,onClick:m,sx:{p:0,display:"flex",borderBottomLeftRadius:0,borderBottomRightRadius:0},color:"neutral100",variant:"outlined",children:e(Zt,{teamCharId:t,showSetting:!0})}),e(k,{sx:{p:1},children:n(o,{container:!0,columns:oa,spacing:1,children:[r.map(c=>e(o,{item:!0,xs:1,children:e(Ae,{teamId:c,onClick:i=>a(`/teams/${c}${i?`/${i}`:""}`)})},c)),e(o,{item:!0,xs:1,children:e(M,{fullWidth:!0,sx:{height:"100%",backgroundColor:"contentNormal.main"},variant:"outlined",onClick:()=>u(t),color:"info",startIcon:e(Z,{}),children:s("charContentModal.addTeam")})})]})})]},t)]})}var N={},ye;function ha(){if(ye)return N;ye=1;var t=Ie();Object.defineProperty(N,"__esModule",{value:!0}),N.default=void 0;var r=t(Se()),s=Me(),a=(0,r.default)((0,s.jsx)("path",{d:"M17.5 9.5C17.5 6.46 15.04 4 12 4S6.5 6.46 6.5 9.5c0 2.7 1.94 4.93 4.5 5.4V17H9v2h2v2h2v-2h2v-2h-2v-2.1c2.56-.47 4.5-2.7 4.5-5.4zm-9 0C8.5 7.57 10.07 6 12 6s3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5z"}),"Female");return N.default=a,N}var ua=ha();const pa=De(ua);var K={},Ce;function ma(){if(Ce)return K;Ce=1;var t=Ie();Object.defineProperty(K,"__esModule",{value:!0}),K.default=void 0;var r=t(Se()),s=Me(),a=(0,r.default)((0,s.jsx)("path",{d:"M9.5 11c1.93 0 3.5 1.57 3.5 3.5S11.43 18 9.5 18 6 16.43 6 14.5 7.57 11 9.5 11zm0-2C6.46 9 4 11.46 4 14.5S6.46 20 9.5 20s5.5-2.46 5.5-5.5c0-1.16-.36-2.23-.97-3.12L18 7.42V10h2V4h-6v2h2.58l-3.97 3.97C11.73 9.36 10.66 9 9.5 9z"}),"Male");return K.default=a,K}var ga=ma();const fa=De(ga);function xa(){const{t}=E("ui"),r=W(),{character:s}=p.useContext(z),{key:a}=s,{gender:l}=de(),u=p.useCallback(()=>r.dbMeta.set({gender:l==="F"?"M":"F"}),[l,r]);return a.startsWith("Traveler")?n(M,{onClick:u,startIcon:l==="F"?e(pa,{}):e(fa,{}),children:[e("strong",{children:t(`gender.${l}`)})," "]}):null}function ya({onClose:t}){const{t:r}=E(["page_character","sillyWisher_charNames","charNames_gen"]),s=F(),a=W(),{character:l,character:{key:u}}=p.useContext(z),{gender:d}=de(),m=st(u,d),{silly:y}=p.useContext(ke),c=p.useCallback(async()=>{const i=r(`${y?"sillyWisher_charNames":"charNames_gen"}:${lt(u,d)}`);window.confirm(r("removeCharacter",{value:i}))&&(a.chars.remove(u),s("/characters"))},[a,s,u,d,y,r]);return n(h,{display:"flex",flexDirection:"column",gap:1,children:[n(h,{display:"flex",gap:1,children:[e(xa,{}),e(M,{color:"error",onClick:()=>c(),startIcon:e(ie,{}),sx:{marginLeft:"auto"},children:r("delete")}),!!t&&e(ce,{onClick:t,children:e(Q,{})})]}),e(h,{children:n(o,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[e(o,{item:!0,xs:8,sm:5,md:4,lg:3,children:n(w,{bgt:"light",sx:{height:"100%",display:"flex",flexDirection:"column",gap:1},children:[e(Vt,{}),e(h,{sx:{px:1},children:e(ct,{level:l.level,ascension:l.ascension,setBoth:i=>{me.includes(u)?me.forEach(f=>{a.chars.set(f,i)}):a.chars.set(u,i)}})}),e(it,{bgt:"light"}),e(A,{sx:{textAlign:"center",pb:-1},variant:"h6",children:e(ot,{characterKey:u,gender:d})}),e(h,{sx:{px:1},children:e(Ht,{setConstellation:i=>a.chars.set(u,{constellation:i})})})]})}),n(o,{item:!0,xs:12,sm:7,md:8,lg:9,sx:{display:"flex",flexDirection:"column",gap:1},children:[e(h,{children:e(o,{container:!0,columns:3,spacing:1,children:["auto","skill","burst"].map(i=>{var f;return e(o,{item:!0,xs:1,children:e(Ut,{talentKey:i,dropDownButtonProps:{startIcon:e(be,{src:(f=m.getTalentOfKey(i))==null?void 0:f.img,size:1.75,sideMargin:!0})},setTalent:C=>a.chars.set(u,T=>{T.talent[i]=C})},i)},i)})})}),e(Ca,{}),e(ba,{})]})]})})]})}function Ca(){const{character:{key:t,equippedArtifacts:r}}=p.useContext(z),{data:s}=p.useContext(Ee),a=W(),l=le(t).weaponType,u=s.get(ge.weapon.id).value,d=p.useMemo(()=>dt(ht,m=>s.get(ge.art[m].id).value),[s]);return e(h,{children:e(ut.Provider,{value:"equipped",children:e(Jt,{weaponTypeKey:l,weaponId:u,artifactIds:d,setWeapon:m=>{a.weapons.set(m,{location:fe(t)})},setArtifact:(m,y)=>{y?a.arts.set(y,{location:fe(t)}):a.arts.set(r[m],{location:""})}})})})}function ba(){const{t}=E("page_character"),r=F(),{character:{key:s}}=p.useContext(z),a=W(),{gender:l}=de(),u=xe(a.teamChars),d=xe(a.teams),m=p.useMemo(()=>{const c={};return[...u].sort((C,T)=>{const[,I]=C,[,x]=T;return I.name.localeCompare(x.name)}).map(([C,T])=>{T.key===s&&(c[C]||(c[C]=[]))}),[...d].sort((C,T)=>{const[,I]=C,[,x]=T;return I.name.localeCompare(x.name)}).forEach(([C,T])=>{const I=T.loadoutData.find(x=>{var v;return x&&((v=a.teamChars.get(x==null?void 0:x.teamCharId))==null?void 0:v.key)===s});I&&c[I==null?void 0:I.teamCharId].push(C)}),c},[u,d,s,a.teamChars]),y=()=>{const c=a.teams.new(),i=a.teamChars.new(s);a.teams.set(c,f=>{f.loadoutData[0]={teamCharId:i}}),r(`/teams/${c}`)};return n(h,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e(A,{variant:"h6",children:n(se,{t,i18nKey:"charContentModal.loadoutsWith",children:["Team Loadouts with"," ",e(pt,{characterKey:s,gender:l})]})}),!Object.values(m).length&&e(ea,{}),Object.entries(m).map(([c,i])=>e(da,{teamCharId:c,teamIds:i},c)),e(M,{fullWidth:!0,onClick:()=>y(),color:"info",startIcon:e(Z,{}),variant:"outlined",sx:{backgroundColor:"contentLight.main"},children:t("charContentModal.addLoAndTeam")}),e(w,{bgt:"light"})]})}function va({characterKey:t,onClose:r}){return e(oe,{open:!!t,onClose:r,children:e(p.Suspense,{fallback:e(q,{variant:"rectangular",width:"100%",height:1e3}),children:t&&e(Ta,{characterKey:t,onClose:r},t)})})}function Ta({characterKey:t,onClose:r}){const s=mt(t),a=gt(t),{target:l}=(a==null?void 0:a[t])??{},u=p.useMemo(()=>{if(!(!a||!l))return{data:l,teamData:a,compareData:void 0}},[l,a]),d=p.useMemo(()=>s&&{character:s},[s]),[m,y]=p.useState(),[c,i]=p.useState(),f=p.useMemo(()=>({chartData:m,setChartData:y,graphBuilds:c,setGraphBuilds:i}),[m,c]);return p.useEffect(()=>{y(void 0),i(void 0)},[t]),e(w,{children:e(k,{sx:{display:"flex",flexDirection:"column",gap:1},children:e(p.Suspense,{fallback:e(q,{variant:"rectangular",width:"100%",height:1e3}),children:u&&d&&f?e(z.Provider,{value:d,children:e(Ee.Provider,{value:u,children:e(ft.Provider,{value:f,children:e(ya,{onClose:r})})})}):e(q,{variant:"rectangular",width:"100%",height:1e3})})})})}const wa={xs:1,sm:2,md:3,lg:4,xl:4},Ia={xs:5,sm:8,md:9,lg:12,xl:12},Sa=Object.keys(je);function Wa(){const t=W(),r=F(),{params:{characterKey:s}}=xt({path:"/characters/:characterKey",end:!1})??{params:{}},a=p.useMemo(()=>s?yt(s)?(t.chars.get(s)||t.chars.getWithInitWeapon(s),s):(r("/characters"),null):null,[s,r,t]),{t:l}=E(["page_character","sillyWisher_charNames","charNames_gen"]),{silly:u}=p.useContext(ke),d=Ct(t.displayCharacter),[m,y]=p.useState(""),c=p.useDeferredValue(m),i=bt(),[f,C]=p.useState(!1);Xt()&&vt.send({hitType:"pageview",page:"/characters"});const T=Tt(t.charMeta),I=ta(),x=wt(t.chars),v=x.length,S=p.useMemo(()=>{const{element:g,weaponType:L,rarity:O,sortType:D,ascending:J}=d;return T&&x.filter(It({element:g,weaponType:L,rarity:O,name:c},Lt(t,u))).sort(St(je[D]??[],J,Ot(t,u),["new","favorite"]))},[d,T,x,c,t,u]),{weaponType:G,element:V,rarity:X,sortType:ee,ascending:te}=d,H=p.useMemo(()=>ne(_t,g=>Object.entries(t.chars.data).forEach(([L,O])=>{const D=t.weapons.get(O.equippedWeapon);if(!D)return;const J=Rt(D.key).weaponType;g[J].total++,S.includes(L)&&g[J].current++})),[t,S]),b=p.useMemo(()=>ne(Nt,g=>Object.entries(t.chars.data).forEach(([L,O])=>{const D=Ft(O.key);g[D].total++,S.includes(L)&&g[D].current++})),[t,S]),j=p.useMemo(()=>ne(Kt,g=>Object.entries(t.chars.data).forEach(([L,O])=>{const D=le(O.key).rarity;g[D].total++,S.includes(L)&&g[D].current++})),[t,S]),{numShow:U,setTriggerElement:Le}=Mt(Ia[i],S.length),ae=p.useMemo(()=>S.slice(0,U),[S,U]),Oe=S.length!==v?`${S.length}/${v}`:`${v}`,Re={numShowing:ae.length,total:Oe,t:l,namespace:"page_character"},_e={sortKeys:[...Sa],value:ee,onChange:g=>t.displayCharacter.set({sortType:g}),ascending:te,onChangeAsc:g=>t.displayCharacter.set({ascending:g})};return n(h,{display:"flex",flexDirection:"column",gap:1,children:[a&&e(va,{characterKey:a,onClose:()=>r("/characters")}),e(p.Suspense,{fallback:!1,children:e(Dt,{newFirst:!0,show:f,onHide:()=>C(!1),onSelect:I})}),e(w,{children:n(k,{sx:{display:"flex",flexDirection:"column",gap:1},children:[n(o,{container:!0,spacing:1,children:[e(o,{item:!0,children:e(kt,{sx:{height:"100%"},onChange:g=>t.displayCharacter.set({weaponType:g}),value:G,totals:H,size:"small"})}),e(o,{item:!0,children:e(Et,{sx:{height:"100%"},onChange:g=>t.displayCharacter.set({element:g}),value:V,totals:b,size:"small"})}),e(o,{item:!0,children:e(jt,{sx:{height:"100%"},onChange:g=>t.displayCharacter.set({rarity:g}),value:X,totals:j,size:"small"})}),e(o,{item:!0,flexGrow:1}),e(o,{item:!0,children:e(Wt,{autoFocus:!0,value:m,onChange:g=>y(g.target.value),label:l("characterName"),size:"small",sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]}),e(h,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:e(Bt,{showingTextProps:Re,sortByButtonProps:_e})})]})}),e(M,{fullWidth:!0,onClick:()=>C(!0),color:"info",startIcon:e(Z,{}),children:l("addNew")}),e(p.Suspense,{fallback:e(q,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:e(o,{container:!0,spacing:1,columns:wa,children:ae.map(g=>e(o,{item:!0,xs:1,children:e(At,{characterKey:g,onClick:()=>r(`${g}`),hideStats:!0})},g))})}),S.length!==ae.length&&e(q,{ref:g=>{g&&Le(g)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100})]})}export{Wa as default};
